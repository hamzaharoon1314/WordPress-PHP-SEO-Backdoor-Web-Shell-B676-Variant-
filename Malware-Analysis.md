# Malware Analysis Report: fzjointpn.cycalmho.site Backdoor

## üß† Overview

This PHP script is a **malicious backdoor** designed to give an attacker remote access to a compromised web server. It communicates with a Command & Control (C2) server located at `fzjointpn.cycalmho.site` and can perform multiple covert actions such as file creation, data exfiltration, dynamic content injection, and stealthy bot avoidance.

---

## üîç Decoded & Static Details

### ‚úÖ Hardcoded C2 URL

```php
$goweb = 'fzjointpn.cycalmho.site';
```

### ‚úÖ Hashed Credentials

* Access password:

  ```
  f75fd5acd36a7fbd1e219b19881a5348bfc66e79 = sha1(sha1(YOUR_PASSWORD))
  ```
* Bypass key:

  ```
  f8f0dae804368c0334e22d9dcb70d3c7bbfa9635 = sha1(sha1(KEY_B))
  ```
* `$a` is dynamically validated against remote response from:

  ```
  https://fzjointpn.cycalmho.site/a.php
  ```

### ‚úÖ Obfuscated CSS Filename

```php
$cssn = str_rot13(substr($host_nw,0,3).substr($goweb,0,3)).'.css';
```

This generates a `.css` filename using rot13, hiding its purpose and aiding in persistence.

---

## ‚öôÔ∏è Functionality Breakdown

### 1. **Initial Setup**

* Sets unlimited execution time.
* Prevents user abort.
* Captures request URI, language, referrer.
* Checks for HTTPS.

### 2. **Password-Protected Backdoor**

If `?pd=` matches the known SHA-1 hash:

* Accepts `mapname` and `dstr` to write arbitrary files.
* Accepts `action=put` to:

  * Create fake Google verification files.
  * Modify `robots.txt` and `sitemap.xml`.
  * Append `Sitemap:` directive if needed.
* Accepts `$a` or `$b` tokens to bypass auth.

### 3. **Bot Detection**

```php
function disbot()
```

Returns `true` if `User-Agent` matches Googlebot, Bingbot, Yahoo, etc. Payload is suppressed for bots.

### 4. **CSS Payload Delivery**

```php
fcss($dpath,$ps,$urlc);
```

* Downloads `style.css` from attacker site.
* Saves under obfuscated name (e.g., `css/abcxyz.css`).
* Serves this local CSS to users.

### 5. **Data Exfiltration**

Sends server/environment data via POST to:

```php
https://fzjointpn.cycalmho.site/indexnew.php
```

Payload includes:

* Host
* Language
* URI
* Referrer
* Bot status

### 6. **Dynamic Response Handling**

The attacker server can return any of:

* `okhtmlgetcontent`: full HTML page
* `okxmlgetcontent`: XML response
* `pingxmlgetcontent`: Sitemap pinging
* `getcontent404page`: Send 404 error
* `getcontent500page`: Send 500 error
* `getcontent301page`: Redirect user

---

## üõ†Ô∏è Persistence Tactics

* CSS file in a writable folder (`css/` or `wp-includes/css/`).
* May disguise payload in a legitimate-looking `.css`.
* Skips bots to remain undetected by crawlers.

---

## üß™ Behavior Summary Table

| Component                   | Description                            |
| --------------------------- | -------------------------------------- |
| `fzjointpn.cycalmho.site`   | C2 server receiving & sending commands |
| `mapname`, `dstr`           | Remote file creation                   |
| `robots.txt`, `sitemap.xml` | SEO disguise files                     |
| `style.css` (remote)        | Obfuscated persistent loader           |
| Bot filter                  | Prevents Google/Bing/Yahoo detection   |
| `a`, `b` keys               | Secondary hidden access                |
| Fake 404/500/301            | Dynamic user deception                 |

---
